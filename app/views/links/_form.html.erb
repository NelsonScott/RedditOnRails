<% action_url = link.persisted? ? link_url(url) : links_url %>
<% http_method = link.persisted? ? "PATCH" : "POST" %>

<form action="<%= action_url %>" method="POST">
  <input type="hidden" name="_method" value="<%= http_method %>">
  <input
    type="hidden"
    name="authenticity_token"
    value="<%= form_authenticity_token %>">

  <label>
    URL:
    <input name="link[url]" value="<%= link.url %>">
  </label>
  <br>

  <label>
    Title:
    <input name="link[title]" value="<%= link.title %>">
  </label>
  <br>

  <label>
    Body:
    <input name="link[body]" value="<%= link.body %>">
  </label>
  <br>

  <input type="hidden" name="link[sub_ids][]" value="">
  <% Sub.all.each do |sub| %>
    <label>
      <input
        type="checkbox"
        name="link[sub_ids][]"
        value="<%= sub.id %>"
        <%= "checked" if link.sub_ids.include?(sub.id) %>>
      <%= sub.name %>
    </label>
    <br>
  <% end %>

  <input type="Submit" value="Submit">
</form>
